name: üìì –î–Ω–µ–≤–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è

on:
  schedule:
    - cron: "0 18 * * *"   # –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 18:00
  workflow_dispatch:

jobs:
  track-mood:
    runs-on: ubuntu-latest

    permissions:
      contents: write   # ‚ùó –î–∞–µ—Ç Actions –ø—Ä–∞–≤–æ –¥–µ–ª–∞—Ç—å git push

    steps:
      - name: üì• Checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}   # –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–æ–∫–µ–Ω

      - name: ‚úèÔ∏è –°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å mood_diary.txt
        run: |
          TODAY=$(date +"%Y-%m-%d")

          if [ ! -f mood_diary.txt ]; then
            echo "üìò –î–ù–ï–í–ù–ò–ö –ù–ê–°–¢–†–û–ï–ù–ò–Ø" > mood_diary.txt
            echo "" >> mood_diary.txt
          fi

          echo "${TODAY}: ____________________" >> mood_diary.txt

      - name: üìÑ –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª
        run: cat mood_diary.txt

      - name: üíæ –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        run: |
          git config user.email "github-actions@github.com"
          git config user.name "GitHub Actions"

          git add mood_diary.txt
          git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –∑–∞ $(date +'%Y-%m-%d')" || echo "–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π"
          git push
