name: üí¨ –î–Ω–µ–≤–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è

on:
  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 18:00
  schedule:
    - cron: '0 22 * * *'

  # –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é
  workflow_dispatch:

jobs:
  track-mood:
    runs-on: ubuntu-latest

    steps:
      # –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      - name: üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–¥
        uses: actions/checkout@v4

      # –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –¥–Ω–µ–≤–Ω–∏–∫–∞
      - name: üìù –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –¥–Ω–µ–≤–Ω–∏–∫
        run: |
          # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ì–ì–ì–ì-–ú–ú-–î–î
          TODAY=$(date '+%Y-%m-%d')
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª
          if [ ! -f "mood_diary.txt" ]; then
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
            echo "–î–ù–ï–í–ù–ò–ö –ù–ê–°–¢–†–û–ï–ù–ò–Ø" > mood_diary.txt
            echo "" >> mood_diary.txt
          fi
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∑–∞–ø–∏—Å—å –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
          if grep -q "$TODAY:" mood_diary.txt; then
            echo "–ó–∞–ø–∏—Å—å –Ω–∞ —Å–µ–≥–æ–¥–Ω—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
          else
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
            echo "$TODAY: ______" >> mood_diary.txt
            echo "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ $TODAY"
          fi

      # –®–∞–≥ 3: –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
      - name: üëÄ –ü–æ–∫–∞–∑–∞—Ç—å –¥–Ω–µ–≤–Ω–∏–∫
        run: |
          echo "=== –¢–µ–∫—É—â–∏–π –¥–Ω–µ–≤–Ω–∏–∫ ==="
          if [ -f "mood_diary.txt" ]; then
            cat mood_diary.txt
          else
            echo "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
          fi

      # –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git
      - name: üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        run: |
          # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Git
          git config --global user.email "github-actions@github.com"
          git config --global user.name "GitHub Actions"
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
          if git diff --quiet; then
            echo "–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
          else
            # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
            git add .
            
            # –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
            TODAY=$(date '+%Y-%m-%d')
            git commit -m "ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ $TODAY"
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
            git push
            echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
          fi
